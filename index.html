<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Котик ловит рыбку</title>
  <meta name="build-version" content="2024-06-02T20:00:00Z">
  <script>
    (function () {
      const versionMeta = document.querySelector('meta[name="build-version"]');
      const cacheTag = versionMeta ? versionMeta.content.trim() : Date.now().toString();

      const appendAsset = (tagName, attributes) => {
        const element = document.createElement(tagName);
        Object.entries(attributes).forEach(([key, value]) => {
          element.setAttribute(key, value);
        });
        document.head.appendChild(element);
        return element;
      };

      appendAsset('link', {
        rel: 'stylesheet',
        href: `styles.css?v=${cacheTag}`,
      });

      appendAsset('script', {
        src: `game.js?v=${cacheTag}`,
        type: 'module',
      });
    })();
  </script>
</head>
<body>
  <div class="game-container">
    <h1>Котик ловит рыбку</h1>
    <div id="mode-overlay" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="mode-title">
      <div class="modal-card">
        <h2 id="mode-title">Выберите режим игры</h2>
        <div class="modal-actions">
          <button id="start-single" type="button">Соло</button>
          <button id="start-multiplayer" type="button">Мультиплеер</button>
        </div>
      </div>
    </div>
    <div id="multiplayer-overlay" class="modal-overlay hidden" role="dialog" aria-modal="true">
      <div class="modal-card" id="multiplayer-prejoin">
        <h2>Мультиплеер</h2>
        <form id="multiplayer-join-form" class="multiplayer-form">
          <label class="scoreboard-label" for="multiplayer-name">Ваше имя</label>
          <input id="multiplayer-name" name="multiplayer-name" type="text" maxlength="32" autocomplete="name" placeholder="Котолюбитель" required>
          <label class="scoreboard-label" for="multiplayer-room">Название комнаты</label>
          <input id="multiplayer-room" name="multiplayer-room" type="text" maxlength="32" placeholder="Например, kotiki" required>
          <div class="modal-actions">
            <button type="submit">Войти</button>
            <button id="multiplayer-cancel" type="button">Назад</button>
          </div>
          <p id="multiplayer-error" class="multiplayer-error" role="alert"></p>
        </form>
      </div>
      <div class="modal-card hidden" id="multiplayer-lobby" role="document">
        <h2>Комната: <span id="multiplayer-room-label"></span></h2>
        <p id="multiplayer-status" class="multiplayer-status" role="status"></p>
        <ul id="multiplayer-player-list" class="multiplayer-player-list"></ul>
        <div class="modal-actions">
          <button id="multiplayer-ready" type="button">Готов</button>
          <button id="multiplayer-leave" type="button">Выйти</button>
        </div>
      </div>
    </div>
    <div id="multiplayer-hud" class="multiplayer-hud hidden" aria-live="polite">
      <div class="multiplayer-hud-header">
        <div>Комната: <span id="multiplayer-hud-room"></span></div>
        <div id="multiplayer-countdown" class="multiplayer-countdown"></div>
      </div>
      <ul id="multiplayer-hud-players" class="multiplayer-hud-players"></ul>
      <div id="multiplayer-game-message" class="multiplayer-game-message"></div>
    </div>
    <div class="hud">
      <div>Очки: <span id="score">0</span></div>
      <div>Время: <span id="timer">10.0</span> c</div>
      <div class="status-effect" aria-live="polite">
        <span class="status-effect-label">Эффект:</span>
        <span
          id="status-effect-icon"
          class="status-effect-icon"
          role="img"
          aria-label="Нет эффектов"
        >—</span>
      </div>
    </div>
    <div class="playfield">
      <canvas id="game" width="500" height="500" aria-label="Игровое поле"></canvas>
      <div class="controls" role="group" aria-label="Экранный джойстик для сенсорных устройств">
        <div class="joystick" aria-hidden="true">
          <div class="joystick-base">
            <div class="joystick-thumb" aria-hidden="true"></div>
          </div>
        </div>
        <div class="joystick-hint" aria-hidden="true">Перетащи кружок, чтобы управлять котиком</div>
      </div>
    </div>
    <div id="message" role="status"></div>
    <button id="restart" type="button">Играть снова</button>
    <section class="scoreboard" aria-labelledby="scoreboard-title">
      <h2 id="scoreboard-title">Таблица лидеров</h2>
      <ol id="leaderboard" class="scoreboard-list"></ol>
      <form id="submit-score" class="scoreboard-form">
        <label class="scoreboard-label" for="player-name">Ваше имя</label>
        <div class="scoreboard-controls">
          <input
            id="player-name"
            name="player-name"
            type="text"
            maxlength="32"
            autocomplete="name"
            placeholder="Котолюбитель"
            required
          >
          <button id="save-score" type="submit">Сохранить очки</button>
        </div>
      </form>
      <p id="score-status" class="scoreboard-status" role="status" aria-live="polite"></p>
    </section>
  </div>
</body>
</html>
